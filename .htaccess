# Enable mod_rewrite
RewriteEngine On

########## 1. Force non-www (adjust domain if needed) ##########
RewriteCond %{HTTP_HOST} ^www\.xartum\.ag$ [NC]
RewriteRule ^(.*)$ https://xartum.ag/$1 [L,R=301]

########## 2. Redirect /index or /index.html to "/" ##########
RewriteCond %{THE_REQUEST} /index(\.html)?[\s?] [NC]
RewriteRule ^index(\.html)?$ / [R=301,L]

########## 3. Redirect other .html URLs to clean versions ##########
RewriteCond %{THE_REQUEST} \s/+(.+?)\.html[\s?] [NC]
RewriteCond %{REQUEST_URI} !^/index\.html$ [NC]
RewriteRule ^(.+?)\.html$ /%1 [R=301,L]

########## 4. Allow direct access to existing files/directories ##########
RewriteCond %{REQUEST_FILENAME} -f
RewriteRule ^ - [L]

RewriteCond %{REQUEST_FILENAME} -d
RewriteRule ^ - [L]

########## 5. Internally rewrite clean URLs to .html files ##########
RewriteRule ^([a-zA-Z0-9/_-]+)/?$ $1.html [L]

########## 6. Default Charset ##########
AddDefaultCharset UTF-8

########## 7. Long-term Caching for Static Assets ##########
<IfModule mod_expires.c>
    ExpiresActive On
    ExpiresDefault "access plus 1 year"
</IfModule>

<IfModule mod_headers.c>
    <FilesMatch "\.(js|css|png|jpg|jpeg|gif|webp|svg|woff2?)$">
        Header set Cache-Control "public, max-age=31536000, immutable"
    </FilesMatch>
</IfModule>
